<div class="page-profile">
  <div class="profile-grid">
    <aside class="profile-menu card mt-0">
      <ul class="layout-menu">
        @for (group of menuGroups; track group.label) {
          <li class="layout-root-menuitem">
            <div class="layout-menuitem-root-text">{{ group.label }}</div>
            <ul class="layout-root-submenulist">
              @for (item of group.items; track item.label) {
                <li>
                  <a [routerLink]="item.routerLink"
                     routerLinkActive="active-route"
                     [routerLinkActiveOptions]="{ exact: true }"
                     class="layout-menuitem-link"
                     pRipple>
                    <i [class]="item.icon + ' layout-menuitem-icon'"></i>
                    <span class="layout-menuitem-text">{{ item.label }}</span>
                  </a>
                </li>
              }
            </ul>
          </li>
        }
      </ul>
    </aside>

    <section class="profile-content-wrapper">
      <div class="profile-content card mt-0">

          <div class="flex items-start flex-col lg:flex-row lg:justify-between">
            <div class="flex items-stretch flex-col md:flex-row gap-8">
              <p-avatar *ngIf="user && (user?.avatar_url || user?.avatar || user?.profile_image || user?.photo || user?.avatar_id) ; else avatarInitialsTpl"
                        [image]="avatarUrl()"
                        shape="circle" styleClass="full-avatar self-stretch"></p-avatar>
              <ng-template #avatarInitialsTpl>
                <p-avatar [label]="personInitials(user?.name || user?.first_name || user?.firstName)"
                          shape="circle"
                          [style.background]="user?.id ? issueAvatarColor({ id: user.id, first_name: user.first_name }) : undefined"
                          [style.color]="user?.id ? issueAvatarTextColor({ id: user.id, first_name: user.first_name }) : undefined"
                          styleClass="full-avatar self-stretch"></p-avatar>
              </ng-template>
              <div class="flex flex-col gap-4">
                <div class="flex items-center">
                  <span class="text-surface-900 dark:text-surface-0 font-bold text-3xl">{{ userName() || ('MENU.PROFILE' | translate) }}</span>
                </div>
                <div class="flex items-center flex-wrap gap-8">
                  <div>
                    <span class="text-surface-500 dark:text-surface-300">{{ 'MENU.EMAIL' | translate }}</span>
                    <div class="text-surface-700 dark:text-surface-100 mt-1 text-sm font-semibold">{{ user?.email || '-' }}</div>
                  </div>
                  <!-- Username removed as requested -->
                  <div>
                    <span class="text-surface-500 dark:text-surface-300">{{ 'MENU.PHONE' | translate }}</span>
                    <div class="text-surface-700 dark:text-surface-100 mt-1 text-sm font-semibold">{{ user?.phone || '-' }}</div>
                  </div>
                  <div>
                    <span class="text-surface-500 dark:text-surface-300">{{ 'MENU.DEPARTMENT' | translate }}</span>
                    <div class="text-surface-700 dark:text-surface-100 mt-1 text-sm font-semibold">{{ user?.department || '-' }}</div>
                  </div>
                  <div>
                    <span class="text-surface-500 dark:text-surface-300">{{ 'MENU.JOB_TITLE' | translate }}</span>
                    <div class="text-surface-700 dark:text-surface-100 mt-1 text-sm font-semibold">{{ user?.job_title || '-' }}</div>
                  </div>
                </div>
              </div>
            </div>
            <div class="mt-2 lg:mt-0 flex items-start gap-3">
              <!-- Edit profile -->
              <button pButton type="button" class="p-button-rounded p-button-text" aria-label="{{ 'MENU.EDIT_PROFILE' | translate }}" title="{{ 'MENU.EDIT_PROFILE' | translate }}" (click)="onEditProfile()">
                <i class="pi pi-pencil"></i>
              </button>

              <!-- Reset password / security -->
              <button pButton type="button" class="p-button-rounded p-button-text" aria-label="{{ 'MENU.RESET_PASSWORD' | translate }}" title="{{ 'MENU.RESET_PASSWORD' | translate }}" (click)="onResetPassword()">
                <i class="pi pi-key"></i>
              </button>

              <!-- Share rights -->
              <button pButton type="button" class="p-button-rounded p-button-text" aria-label="{{ 'MENU.SHARE_RIGHTS' | translate }}" title="{{ 'MENU.SHARE_RIGHTS' | translate }}" (click)="onShareRights()">
                <i class="pi pi-users"></i>
              </button>
            </div>
          </div>

        </div>

        <router-outlet></router-outlet>
    </section>
  </div>
</div>
